define(function(require) {
    'use strict';
    var jssdk=require("http://res.wx.qq.com/open/js/jweixin-1.0.0");return function(a,b){var c,d;return d=function(c,d){var k,l,f=b.isType("json",d)?d:{},g=this._target=a(c),h=this._tips=a('<div class="-share-tips"></div>').append('<i class="-share-tips-hand"></i>'),i=b.isType("number",f.speed)?f.speed:300,j=b.getRandom();a(document.body).append(h),k=this.bindEvent=function(b){b?a(b).on("click",function(){l("in")}):(g.on("click",function(){l("in")}),h.on("click",function(){l("out")}))},l=this.toggle=function(a){"in"===a?b.ui.toggleBlur(j,{target:h,callback:function(){h.css({zIndex:b.getZIndex(h)}).fadeIn(i)}}):"out"===a&&b.ui.toggleBlur(j,{callback:function(){h.fadeOut(i,function(){h.css({zIndex:-1})})}})},k()},c=b.ext.WechatAPI=function(c,e){var n,o,p,g=c.xhr,h=c.cfg,i=b.isType("json",e)?e:{},j=this._param={},k=i.config=b.isType("json",i.config)?i.config:{},l=k.item=b.isType("json",k.item)?k.item:{},m=new Image;m.src=h.imgUrl,j.xhr={url:b.isType("string",g.url)?g.url:"/",type:!b.isType("string",g.type)||"GET"!=g.type.toUpperCase()&&"POST"!=g.type.toUpperCase()?"GET":g.type.toUpperCase(),data:b.isType("json",g.data)?g.data:{},dataType:!b.isType("string",g.dataType)||"json"!=g.dataType&&"jsonp"!=g.dataType&&"xml"!=g.dataType&&"text"!=g.dataType&&"html"!=g.dataType&&"script"!=g.dataType?"json":g.dataType},j.cfg={title:b.isType("string",h.title)?h.title:document.title,desc:b.isType("string",h.desc)?h.desc:document.querySelector('meta[name="descripton"]').content,link:b.isType("string",h.link)?h.link:b.host.href,imgUrl:m.src},j.config={api:b.isType("array",k.api)?k.api:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","showOptionMenu","hideOptionMenu","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem"],menu:b.isType("boolean",k.menu)?k.menu:!0,item:{base:b.isType("boolean",l.base)?l.base:!1,hide:b.isType("boolean",l.hide)?l.hide:[],show:b.isType("array",l.show)?l.show:["menuItem:share:appMessage","menuItem:share:timeline","menuItem:share:qq","menuItem:share:weiboApp","menuItem:favorite"]}},this.onReady=i.onReady,n=this.pushState=function(c){var c=b.isType("json",c)?c:{},d=b.isType("json",c.cfg)?c.cfg:{},e=b.isType("json",c.xhr)?c.xhr:j.xhr,f=b.isType("array",c.api)?c.api:j.config.api;a.ajax({url:e.url,type:e.type,data:e.data,dataType:e.dataType,success:function(a){jssdk.config({debug:!1,appId:a.appId,timestamp:a.timestamp,nonceStr:a.nonceStr,signature:a.signature,jsApiList:f}),jssdk.ready(function(){o(d),b.isType("function",c.callback)&&c.callback()})}})},o=function(a){var b=a.title||j.cfg.title,c=a.desc||j.cfg.desc,d=a.link||j.cfg.link,e=a.imgUrl||j.cfg.imgUrl;jssdk.onMenuShareAppMessage({title:b,desc:c,link:d,imgUrl:e,type:"link",dataUrl:"",success:function(){},cancel:function(){}}),jssdk.onMenuShareTimeline({title:b,link:d,imgUrl:e,success:function(){},cancel:function(){}}),jssdk.onMenuShareQQ({title:b,desc:c,link:d,imgUrl:e,success:function(){},cancel:function(){}}),jssdk.onMenuShareWeibo({title:b,desc:c,link:d,imgUrl:e,success:function(){},cancel:function(){}})},p=function(a,b){a?jssdk.showOptionMenu():jssdk.hideOptionMenu(),b.base?jssdk.showAllNonBaseMenuItem():jssdk.hideAllNonBaseMenuItem(),b.hide.length>0&&jssdk.hideMenuItems({menuList:b.hide}),b.show.length>0&&jssdk.showMenuItems({menuList:b.show})},function(a){b.isType("json",a)&&a.target&&(this.tipser=new d(a.target,a.options)),n({cfg:j.cfg,xhr:j.xhr,api:j.config.api,callback:function(){p(j.config.menu,j.config.item)}}),b.isType("function",this.onReady)&&this.onReady(this)}.call(this,c.tips)}};
});